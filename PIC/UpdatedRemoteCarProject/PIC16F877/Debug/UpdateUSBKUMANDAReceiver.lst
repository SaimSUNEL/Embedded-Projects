     1: 
     2: /* Main.c file generated by New Project wizard
     3:  *
     4:  * Created:   Cum Oca 23 2015
     5:  * Processor: PIC16F877
     6:  * Compiler:  HI-TECH C for PIC10/12/16
     7:  */
     8:  char gelen_veri[8];
     9: #include <htc.h>
    10: #define XTAL_FREQ 4MHZ
    11: #define DelayMs __delay_ms
    12: #define DelayUs __delay_us
    13: #define TRUE 1
    14: #define FALSE 0
    15: #define SAG 2
    16: #define SOL 3
    17: int motor_suresi = 0;
    18: char ortala = FALSE;
    19: char motor_aktif = FALSE;
    20: char motor_yon = 0;
    21: int sayi=0;
    22: int j;
    23: int kk = 0;
    24: int sonuc=0;
    25: int a=0;
    26: char code[4];
    27: volatile int temp=0;    
    28: char array[50];
    29: void kodu_coz()
    30: {
    31: sonuc=64*gelen_veri[1]+32*gelen_veri[2]+16*gelen_veri[3]+8*gelen_veri[4]+4*gelen_veri[5]+2*gelen_veri[6]+gelen_veri[7];
    32: array[a++]=sonuc;
    33: if(sonuc=='2'){RB1=1; RC0 = 1; RC2 = 1; RC1 = 0; RC3 = 0;  }
    34: if(sonuc==22)RB1=~RB1;
    35: if(sonuc==33)RB2=~RB2;
    36: if(sonuc=='4'){
    37: for(int b=0;b<3;b++)
    38:         {
    39:                 RC7 = 1;
    40:                  DelayUs( 1498 );
    41:                  RC7 = 0;
    42:                  DelayMs(19);
    43:                 DelayMs( 1 );   } 
    44:          
    45:                 
    46: 
    47:         }
    48: if(sonuc=='5'){ 
    49: for(int a=0;a<3;a++)
    50:  {
    51:            RC7=1;
    52:                   DelayUs(998);
    53:                   RC7=0;
    54:            DelayMs(19);
    55:            DelayMs( 2 );
    56:  }
    57: 
    58: 
    59:         }
    60:         if(sonuc=='7'){ RC0 = 0; RC2 = 0; RC1 = 1; RC3 = 1;  };
    61:         
    62: if(sonuc=='b'){ RB1 = 0; RC0 = 0; RC2 = 0; }
    63: if(sonuc =='d' || sonuc  == 'e' ){
    64: for(int b=0;b<4;b++)
    65:         {
    66:                 RC7 = 1;
    67:                  DelayUs( 1998 );
    68:                  RC7 = 0;
    69:                  DelayMs(19);
    70:                 DelayMs( 1 );   } 
    71:          
    72:          }
    73: 
    74: 
    75: if(sonuc  == 'e' ){
    76: for(int b=0;b<4;b++)
    77:         {
    78:                 RC7 = 1;
    79:                  DelayUs( 1998 );
    80:                  RC7 = 0;
    81:                  DelayMs(19);
    82:                 DelayMs( 1 );   } 
    83:          
    84:          }
    85: 
    86: 
    87: if(sonuc=='g') {RC0 = 0; RC2 = 0; RC1 = 0; RC3 = 0; }
    88: }
    89: 
    90: 
    91: void coz()
    92: {sayi=0;
    93: 
    94:         while( RB0 == 1 ) sayi++;
    95:                 temp = sayi;
    96:         
    97: 
    98:         
    99:         
   100:         if( sayi > 150 && sayi < 162 )
   101: {
   102: 
   103:         DelayUs( 250 -1 );
   104:                 DelayUs( 250 -1 );
   105:         
   106:         if( RB0 == 0 )
   107:         {
   108:         DelayUs( 240 -1 );
   109:                 DelayUs( 230 -1 );
   110:         RC5 = RB0;
   111:         RB7=1;
   112:         
   113:                 
   114: for( kk = 0 ; kk < 8 ; kk ++ )
   115: {
   116:         DelayUs( 250 );
   117:         DelayUs( 120 );
   118:         
   119:         //RB5 = 1;
   120:         gelen_veri[ kk ] = RB0;
   121:         RC5 = RB0 ;
   122:         DelayUs( 250 );
   123:         DelayUs( 120 );
   124:         //RB5 = 0;
   125:         RC5 = RB0;
   126:         DelayUs( 250 - 1 );
   127:         DelayUs( 230 - 1 );
   128:         DelayUs( 220 - 1 );
   129:         
   130: }
   131:         
   132:         
   133:  
   134:  
   135:  kodu_coz();    
   136:  
   137:  
   138:  
   139:  
   140:  
   141:         }
   142:         
   143:         
   144:                         
   145: 
   146:         
   147:         
   148:         
   149:         
   150:         }
   151:         
   152:         
   153:         
   154: 
   155:         
   156:         
   157:         
   158:         
   159:         
   160:         
   161:         }
   162: void main(void)
   163:  {
   164:    TRISB=0b00000001;
   165:          PORTB=0;
   166:          
   167:          TRISC=0;
   168:          PORTC=0;
   169:          
   170:         
   171:          
   172:          // Write your code here
   173:    while (1)
   174:    {
   175:          
   176: 
   177:           
   178:           
   179:            
   180:            
   181:          
   182:            if(RB0==1)
   183:            {
   184:                    coz();
   185:                   }
   186:                   
   187:                  
   188:                   
   189:                  
   190:                   
   191:                  
   192:           } 
   193:           
   194:  
   195:  }
