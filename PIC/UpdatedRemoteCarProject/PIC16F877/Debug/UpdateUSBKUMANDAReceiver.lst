     1: 
     2: /* Main.c file generated by New Project wizard
     3:  *
     4:  * Created:   Cum Oca 23 2015
     5:  * Processor: PIC16F877
     6:  * Compiler:  HI-TECH C for PIC10/12/16
     7:  */
     8:  char gelen_veri[8];
     9: #include <htc.h>
    10: #define XTAL_FREQ 4MHZ
    11: #include "c:/tc/delay.c"
    12: #define TRUE 1
    13: #define FALSE 0
    14: #define SAG 2
    15: #define SOL 3
    16: int motor_suresi = 0;
    17: char ortala = FALSE;
    18: char motor_aktif = FALSE;
    19: char motor_yon = 0;
    20: int sayi=0;
    21: int j;
    22: int kk = 0;
    23: int sonuc=0;
    24: int a=0;
    25: char code[4];
    26: volatile int temp=0;    
    27: char array[50];
    28: void kodu_coz()
    29: {
    30: sonuc=64*gelen_veri[1]+32*gelen_veri[2]+16*gelen_veri[3]+8*gelen_veri[4]+4*gelen_veri[5]+2*gelen_veri[6]+gelen_veri[7];
    31: array[a++]=sonuc;
    32: if(sonuc=='2'){RB1=1; RC0 = 1; RC2 = 1; RC1 = 0; RC3 = 0;  }
    33: if(sonuc==22)RB1=~RB1;
    34: if(sonuc==33)RB2=~RB2;
    35: if(sonuc=='4'){
    36: for(int b=0;b<3;b++)
    37:         {
    38:                 RC7 = 1;
    39:                  DelayUs( 1498 );
    40:                  RC7 = 0;
    41:                  DelayMs(19);
    42:                 DelayMs( 1 );   } 
    43:          
    44:                 
    45: 
    46:         }
    47: if(sonuc=='5'){ 
    48: for(int a=0;a<3;a++)
    49:  {
    50:            RC7=1;
    51:                   DelayUs(998);
    52:                   RC7=0;
    53:            DelayMs(19);
    54:            DelayMs( 2 );
    55:  }
    56: 
    57: 
    58:         }
    59:         if(sonuc=='7'){ RC0 = 0; RC2 = 0; RC1 = 1; RC3 = 1;  };
    60:         
    61: if(sonuc=='b'){ RB1 = 0; RC0 = 0; RC2 = 0; }
    62: if(sonuc =='d' || sonuc  == 'e' ){
    63: for(int b=0;b<4;b++)
    64:         {
    65:                 RC7 = 1;
    66:                  DelayUs( 1998 );
    67:                  RC7 = 0;
    68:                  DelayMs(19);
    69:                 DelayMs( 1 );   } 
    70:          
    71:          }
    72: 
    73: 
    74: if(sonuc  == 'e' ){
    75: for(int b=0;b<4;b++)
    76:         {
    77:                 RC7 = 1;
    78:                  DelayUs( 1998 );
    79:                  RC7 = 0;
    80:                  DelayMs(19);
    81:                 DelayMs( 1 );   } 
    82:          
    83:          }
    84: 
    85: 
    86: if(sonuc=='g') {RC0 = 0; RC2 = 0; RC1 = 0; RC3 = 0; }
    87: }
    88: 
    89: 
    90: void coz()
    91: {sayi=0;
    92: 
    93:         while( RB0 == 1 ) sayi++;
    94:                 temp = sayi;
    95:         
    96: 
    97:         
    98:         
    99:         if( sayi > 150 && sayi < 162 )
   100: {
   101: 
   102:         DelayUs( 250 -1 );
   103:                 DelayUs( 250 -1 );
   104:         
   105:         if( RB0 == 0 )
   106:         {
   107:         DelayUs( 240 -1 );
   108:                 DelayUs( 230 -1 );
   109:         RC5 = RB0;
   110:         RB7=1;
   111:         
   112:                 
   113: for( kk = 0 ; kk < 8 ; kk ++ )
   114: {
   115:         DelayUs( 250 );
   116:         DelayUs( 120 );
   117:         
   118:         //RB5 = 1;
   119:         gelen_veri[ kk ] = RB0;
   120:         RC5 = RB0 ;
   121:         DelayUs( 250 );
   122:         DelayUs( 120 );
   123:         //RB5 = 0;
   124:         RC5 = RB0;
   125:         DelayUs( 250 - 1 );
   126:         DelayUs( 230 - 1 );
   127:         DelayUs( 220 - 1 );
   128:         
   129: }
   130:         
   131:         
   132:  
   133:  
   134:  kodu_coz();    
   135:  
   136:  
   137:  
   138:  
   139:  
   140:         }
   141:         
   142:         
   143:                         
   144: 
   145:         
   146:         
   147:         
   148:         
   149:         }
   150:         
   151:         
   152:         
   153: 
   154:         
   155:         
   156:         
   157:         
   158:         
   159:         
   160:         }
   161: void main(void)
   162:  {
   163:    TRISB=0b00000001;
   164:          PORTB=0;
   165:          
   166:          TRISC=0;
   167:          PORTC=0;
   168:          
   169:         
   170:          
   171:          // Write your code here
   172:    while (1)
   173:    {
   174:          
   175: 
   176:           
   177:           
   178:            
   179:            
   180:          
   181:            if(RB0==1)
   182:            {
   183:                    coz();
   184:                   }
   185:                   
   186:                  
   187:                   
   188:                  
   189:                   
   190:                  
   191:           } 
   192:           
   193:  
   194:  }
